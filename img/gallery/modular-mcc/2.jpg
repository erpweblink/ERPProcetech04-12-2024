 = (G2.FindControl("txt_unit_GET") as Label).Text;
                        string Rate_GET = (G2.FindControl("lbl_rate_GET") as Label).Text;
                        string Discount_GET = (G2.FindControl("lbl_discount_GET") as Label).Text;
                        string Total_Amount_GET = (G2.FindControl("lbl_total_amount_GET") as Label).Text;
                        string MateName = (G2.FindControl("lblproduct") as Label).Text;
                        string PrintDescription = (G2.FindControl("Lblprintdescription_grd") as Label).Text;
                        string InvoiceNo = txt_InvoiceNo.Text;
                        SqlCommand Cmd1 = new SqlCommand("INSERT INTO tbl_Invoice_both_Dtls (InvoiceId,JobNo,Description,Hsn,TaxPercentage,Quntity,Unit,Rate,DiscountPercentage,Total, MateName, PrintDescription, InvoiceNo) " +
                        //"VALUES ('" + Id + "','" + JobNo_GET + "','" + Discription_GET + "','" + HSN_GET + "','" + Tax_GET + "','" + Quntity_GET + "','" + Unit_GET + "','" + Rate_GET + "','" + Discount_GET + "','" + Total_Amount_GET + "')", con);
                        "VALUES ('" + Id + "','" + JobNo_GET + "','" + Discription_GET + "','" + HSN_GET + "','" + Tax_GET + "','" + Quntity_GET + "','" + Unit_GET + "','" + Rate_GET + "','" + Discount_GET + "','" + Total_Amount_GET + "'  ,'" + MateName + "', '" + PrintDescription + "','" + InvoiceNo + "' )", con);
                        con.Open();
                        Cmd1.ExecuteNonQuery();

                        SqlCommand Cmd2 = new SqlCommand("UPDATE CustomerPO_Dtls_Both SET JobStatus = 'Completed', JobDaysCount = '" + JobCreatedCount + "'" +
                        "WHERE JobNo = '" + JobNo_GET + "'", con);                                              
                         Cmd2.ExecuteNonQuery();

                        // Substract the Job count for that quotation 
                        SqlCommand cmdss = new SqlCommand("SELECT PurchaseId FROM CustomerPO_Dtls_Both WHERE JobNo = '" + JobNo_GET + "'", con);
                        object result = cmdss.ExecuteScalar();

                        int purchaseId = 0; 

                        if (result != DBNull.Value && result != null)
                        {
                            purchaseId = Convert.ToInt32(result);  
                        }
                        --JobNoCount;
                        SqlCommand cmds = new SqlCommand("UPDATE CustomerPO_Hdr_Both SET JobNoCount = '" + JobNoCount + "' WHERE id = '" + purchaseId + "'", con);
                        cmds.ExecuteNonQuery();

                        if (JobNoCount == 0)
                        {
                            SqlCommand cmds1 = new SqlCommand("UPDATE CustomerPO_Hdr_Both SET Status = 'Completed' WHERE id = '" + purchaseId + "'", con);
                            cmds1.ExecuteNonQuery();
                        }

                        con.Close();
                    }
                }

                foreach (GridViewRow g1 in Grd_MAIL.Rows)
                {
                    string MAIL = (g1.FindControl("lblmultMail") as Label).Text;
                    bool chkmail = (g1.FindControl("chkmail") as CheckBox).Checked;
                    string lbldesignation = (g1.FindControl("lbldesignation") as Label).Text;
                    SqlCommand cmdtable = new SqlCommand("insert into InvoiceMail(InvoiceNo,Email,CreatedBy,CreatedOn,InvoiceId,chkEmail,designation) values(@InvoiceNo,@Email,@CreatedBy,@CreatedOn,@InvoiceId,@chkEmail,@designation)", con);
                    cmdtable.Parameters.AddWithValue("@InvoiceNo", txt_InvoiceNo.Text);
                    cmdtable.Parameters.AddWithValue("@Email", MAIL);
                    cmdtable.Parameters.AddWithValue("@chkEmail", chkmail);
                    cmdtable.Parameters.AddWithValue("@CreatedBy", CretedBy);
                    cmdtable.Parameters.Add("@InvoiceId", Id);
                    cmdtable.Parameters.Add("@designation", lbldesignation);
                    cmdtable.Parameters.AddWithValue("@CreatedOn", Date);
                    con.Open();
                    cmdtable.ExecuteNonQuery();
                    con.Close();
                }

                ClientScript.RegisterStartupScript(this.GetType(), "alert", "HideLabel('Data saved Sucessfully')", true);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        else
        {
            //string CretedBy = "adminname";
            try
            {
                con.Close();

                SqlCommand Cmd = new SqlCommand("SP_Invoice_both", con);
                Cmd.CommandType = System.Data.CommandType.StoredProcedure;
                Cmd.Parameters.AddWithValue("@InvoiceNo", txt_InvoiceNo.Text);
                Cmd.Parameters.AddWithValue("@InvoiceDate", txt_InvoiceDate.Text);
                Cmd.Parameters.AddWithValue("@InvoiceAgainst", ddlagainst.SelectedItem.Text);
                if (ddlagainst.Text == "Direct")
                {
                    Cmd.Parameters.AddWithValue("@AgainstNo", "Direct");
                }
                if (ddlagainst.Text == "Order")
                {
                    Cmd.Parameters.AddWithValue("@AgainstNo", ddlagainstno.SelectedItem.Text);
                }
                Cmd.Parameters.AddWithValue("@PoNo", txt_PoNo.Text);
                Cmd.Parameters.AddWithValue("@PoDate", txt_poDate.Text);
                Cmd.Parameters.AddWithValue("@CompName", txtCompName.Text);
                Cmd.Parameters.AddWithValue("@CustName", txtCustName.Text);
                Cmd.Parameters.AddWithValue("@ChallanNo", txt_challanNo.Text);
                Cmd.Parameters.AddWithValue("@ChallanDate", txt_ChallanDate.Text);
                Cmd.Parameters.AddWithValue("@PayTerm", txt_Payterm.Text);
                Cmd.Parameters.AddWithValue("@KindAtt", txt_KindAtt.Text);
                Cmd.Parameters.AddWithValue("@CompanyAddress", txt_CompanyAddress.Text);
                Cmd.Parameters.AddWithValue("@CompanyGstNo", txt_CompanyGSTno.Text);
                Cmd.Parameters.AddWithValue("@CompanyPanNo", txt_CompanyPanNo.Text);
                Cmd.Parameters.AddWithValue("@ComapyRegType", drop_CompanyRegisterType.Text);
                Cmd.Parameters.AddWithValue("@CompanyStateCode", txt_CompanyStateCode.Text);
                Cmd.Parameters.AddWithValue("@CustomerShippingAddress", txt_ShipingAdddesss.Text);
                Cmd.Parameters.AddWithValue("@CustomerGstNo", txt_CustomerGstNo.Text);
                Cmd.Parameters.AddWithValue("@CustomerPanNo", txt_CustomerPanNo.Text);
                Cmd.Parameters.AddWithValue("@CustomerRegType", drop_CustomerRagisterType.Text);
                Cmd.Parameters.AddWithValue("@CustomerStateCode", txt_CustomerStateCode.Text);
                Cmd.Parameters.AddWithValue("@CGST", txt_cgst_amt.Text);
                Cmd.Parameters.AddWithValue("@SGST", txt_sgst_amt.Text);
                Cmd.Parameters.AddWithValue("@IGST", txt_igst_amt.Text);
                //  Cmd.Parameters.AddWithValue("@InvoiceId", txt_sgst_amt.Text);
                Cmd.Parameters.AddWithValue("@AllTotalAmount", txt_subtotal.Text);
                Cmd.Parameters.AddWithValue("@GrandTotal", txt_grand_total.Text);
                Cmd.Parameters.AddWithValue("@TotalInWord", lbl_Amount_In_Word.Text);
                Cmd.Parameters.AddWithValue("@Term_Condition_1", txt_term_1.Text + "-" + txt_condition_1.Text);
                Cmd.Parameters.AddWithValue("@Term_Condition_2", txt_term_2.Text + "-" + txt_condition_2.Text);
                Cmd.Parameters.AddWithValue("@Term_Condition_3", txt_term_3.Text + "-" + txt_condition_3.Text);
                Cmd.Parameters.AddWithValue("@Term_Condition_4", txt_term_4.Text + "-" + txt_condition_4.Text);
                Cmd.Parameters.AddWithValue("@Term_Condition_5", txt_term_4.Text + "-" + txt_condition_5.Text);
                Cmd.Parameters.AddWithValue("@Term_Condition_6", txt_term_4.Text + "-" + txt_condition_6.Text);
                Cmd.Parameters.AddWithValue("@ServiceType", ddlservicetype.SelectedItem.Text);
                Cmd.Parameters.AddWithValue("@Is_Deleted", '0');
                Cmd.Parameters.AddWithValue("@CreatedOn", DateTime.Now);
                Cmd.Parameters.AddWithValue("@CreatedBy", CretedBy);
                Cmd.Parameters.AddWithValue("@Type", "JobNo");
                //Cmd.Parameters.AddWithValue("@JobNo", );
      